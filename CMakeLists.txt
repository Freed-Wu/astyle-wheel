cmake_minimum_required(VERSION 3.10)
# cmake-format: off
set(VERSION 3.4.8 CACHE STRING "version of astyle")
# cmake-format: on
include(ExternalProject)
include(GNUInstallDirs)
if(NOT DEFINED SKBUILD_NULL_DIR)
  set(SKBUILD_NULL_DIR ${CMAKE_BINARY_DIR}/null)
endif()
if(NOT DEFINED SKBUILD_DATA_DIR)
  set(SKBUILD_DATA_DIR ${CMAKE_INSTALL_DATADIR})
endif()
if(NOT DEFINED SKBUILD_SCRIPTS_DIR)
  set(SKBUILD_SCRIPTS_DIR ${CMAKE_INSTALL_BINDIR})
endif()
ExternalProject_Add(
  astyle
  URL "https://gitlab.com/saalen/astyle/-/archive/${VERSION}/astyle-${VERSION}.tar.gz"
  CMAKE_ARGS "-DCMAKE_INSTALL_PREFIX=${SKBUILD_NULL_DIR}"
  USES_TERMINAL_DOWNLOAD 1
  USES_TERMINAL_CONFIGURE 1
  USES_TERMINAL_BUILD 1)
install(PROGRAMS ${SKBUILD_NULL_DIR}/bin/astyle DESTINATION ${SKBUILD_SCRIPTS_DIR})
install(DIRECTORY ${SKBUILD_NULL_DIR}/share DESTINATION ${SKBUILD_DATA_DIR})
install(DIRECTORY ${SKBUILD_NULL_DIR}/man DESTINATION ${SKBUILD_DATA_DIR}/share)
